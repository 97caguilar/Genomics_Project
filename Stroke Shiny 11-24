library(shiny)
library(ggplot2)
library(dplyr)
library(shinythemes)
library(markdown)
library(DT)

#change the file directory as we go -- how to host the csv and models and images on Shiny.io ??
dataset <- read.csv("~/Desktop/Genomics_Project-master/stroke_shiny.csv")
#should we use the cleaned model that is used for analysis, or the one that is filtered but still contains the original variables from the data dictionary for the data exploration? 

ui <- navbarPage(
        theme = shinythemes::shinytheme("slate"),
        "Stroke Data",
        tabPanel("Background", 
                 fluidRow(
                     column(12,
                            h3("About"),
                            "This app is designed to investigate results through visualization, summary statistics and model evaluation. We obtained our dataset from Kaggle Healthcare Dataset Stroke Data. This dataset contains information on more than 40,000 patients along dimensions such as gender, BMI, smoke history, and more."),
                     column(6, 
                            offset = 1, 
                            img(src="~/Desktop/Genomics_Project-master/datadictionary.jpg",
                                #can't figure out why the image isn't showing up and it's giving me a little graphic --need to troubleshoot this
                                contentType = "image/jpg"
                            )
                            
                                )
                            )),
        tabPanel("Data Exploration",
                 sidebarPanel(
                    # sliderInput('sampleSize', 'Sample Size', min=1, max=nrow(dataset),
                             #    value=min(50, nrow(dataset)), step=1, round=0),
                     
                     selectInput('x', 'X', names(dataset)),
                     selectInput('y', 'Y', names(dataset), names(dataset)[[2]]),
                     selectInput('color', 'Color', c('None', names(dataset))),
                     
                     checkboxInput('jitter', 'Jitter'),
                     checkboxInput('reg', 'Regression'),
                     
                     selectInput('facet_row', 'Facet Row', c(None='.', names(dataset))),
                     selectInput('facet_col', 'Facet Column', c(None='.', names(dataset)))
                 ),
                 mainPanel(
                     tabsetPanel(
                         tabPanel("Summary Stats",
                                  h4("Table"),
                                  dataTableOutput("table"),
                                  h4("Verbatim text output"),
                                  verbatimTextOutput("txtout")#,
                                  # h1("Header 1"),
                                  # h2("Header 2"),
                                  # h3("Header 3"),
                                  # h4("Header 4"),
                                  # h5("Header 5")
                         ),
                         tabPanel("Plots", "This panel is intentionally left blank")
                     )
                 )
        ),
        tabPanel("Models", "This panel is intentionally left blank")
    )

server <- function(input, output) {
    output$txtout <- renderText({
        paste(input$txt, input$slider, format(input$date), sep = ", ")
    })
    output$table <- renderDataTable(
        dataset %>% select(-X,-id), 
        options = list(rownames = FALSE)
    )
}

shinyApp(ui = ui, server = server)




